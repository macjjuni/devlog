---
title: "React í™˜ê²½ì—ì„œ Jest í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±í•˜ê¸°"
category: Dev
tag: ['React', 'Jest']
date: 2023-12-10
author: ê¾¸ìƒ
---

ì´ë²ˆì—” ì´ì „ ë§Œë“¤ì–´ ë’€ë˜ ë¦¬ì•¡íŠ¸ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ë§ˆì´ê·¸ë ˆì´ì…˜ê³¼ Jest í…ŒìŠ¤íŠ¸ ì½”ë“œ í•™ìŠµê²¸ `<Counter />` ì»´í¬ë„ŒíŠ¸ì— í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ”ë° ì‹œê°„ì„ ë‹¤ ë³´ëƒˆë‹¤. í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” ë‹¤ë¥¸ ì‚¬ëŒì´ ì‘ì„±í•œ ì½”ë“œì— ì»¨ë²¤ì…˜ì„ ìµí˜€ë‘˜ í•„ìš”ê°€ ìˆì–´ë³´ì´ê³  í…ŒìŠ¤íŠ¸ íŒŒì¼ì„ ì–´ë–¤ ì‹ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ì§€ì™€ ë¬´ì—‡ì„ ì¤‘ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•´ì•¼ í•˜ëŠ”ì§€ ë“± ìƒê°í• ê²Œ ë§ì•„ ë³´ì¸ë‹¤.

[GitHub - macjjuni/react18-ts-boilerplate: feat. SWC](https://github.com/macjjuni/react18-ts-boilerplate)

## ğŸ“¦ ì´ˆê¸° ì„¤ì •

### Install: Jest

```jsx
yarn add -D jest @types/jest babel-jest ts-jest ts-node jest-environment-jsdom
```

### Install: React Testing Library

```jsx
yarn add -D @testing-library/react @testing-library/dom @testing-library/jest-dom @testing-library/user-event
```

### jest.config.ts

```jsx
/** @type {import('ts-jest').JestConfigWithTsJest} */
export default {
  preset: 'ts-jest',
  testPathIgnorePatterns: ['<rootDir>/node_modules/'],
  moduleDirectories: ['node_modules', '<rootDir>/'],
  // roots: ['<rootDir>/src/__tests__/'],
  transform: { '^.+\\.(ts|tsx)$': ['ts-jest'] },
  moduleNameMapper: {
  //'\\.(css|less|svg)$': 'identity-obj-proxy',
    '@/(.*)$': '<rootDir>/src/$1', // @ <= alias path
  },
  testEnvironment: 'jsdom',
  setupFilesAfterEnv: ['<rootDir>/jest.setup.ts'],
}
```

### babel.config.js

```jsx
module.exports = {
  presets: ['@babel/preset-env', ['@babel/preset-react', { runtime: 'automatic' }]],
}
```

### jest.setup.ts

```jsx
import '@testing-library/jest-dom'
```

## âš’ï¸ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜

### describe(desc, func)

describe í•¨ìˆ˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ê·¸ë£¹í™”í•˜ê³  ì„¤ì •ì„ ì œê³µí•˜ëŠ”ë° ì‚¬ìš©. í…ŒìŠ¤íŠ¸ ëª¨ìŒ ë‚´ì— ì—¬ëŸ¬ ê°œì˜ testë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŒ.

### test(content, func)

í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì •ì˜í•˜ëŠ” í•¨ìˆ˜. ë‹¨ì¼ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì •ì˜í•˜ê³  ì‹¤í–‰. ê° í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ëŠ” ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ë˜ê³ , `expect` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì˜ˆìƒ ê²°ê³¼ë¥¼ ê²€ì¦í•  ìˆ˜ ìˆë‹¤.

```tsx
describe('sum module', () => {
  test('adds 1 + 2 to equal 3', () => {
    expect(sum(1, 2)).toBe(3);
  });
});
```

### expect(), toBe()

í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì •ì˜í•˜ëŠ” í•¨ìˆ˜. ë‹¨ì¼ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì •ì˜í•˜ê³  ì‹¤í–‰í•œë‹¤. ê° í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ëŠ” ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ë˜ê³ , `expect` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì˜ˆìƒ ê²°ê³¼ë¥¼ ê²€ì¦í•  ìˆ˜ ìˆë‹¤.

```tsx
describe('sum module', () => {
  test('adds 1 + 2 to equal 3', () => {
    expect(sum(1, 2)).toBe(3);
  });
});
```

`expect`ì— ê²°ê³¼ ê°’ê³¼ `toBe` í•¨ìˆ˜ì— ê²°ê³¼ ê°’ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì„±ê³µ ì—¬ë¶€ë¥¼ ì²´í¬.

### toBeInTheDocument()

```tsx
import { screen, render } from "@testing-library/react";
import App from './App'

describe("ì•±ì„ ë Œë”ë§í•©ë‹ˆë‹¤.", () => {
  test("ë²„íŠ¼ì´ ìˆìŠµë‹ˆë‹¤.", () => {
    const render(<App />);
		const buttonEl = screen.getByTestId( 'app-button')
		expect(buttonEl).toBeInTheDocument()
	})
})
```

`toBeInTheDocument()` í•¨ìˆ˜ëŠ” ë¬¸ì„œì— ë²„íŠ¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ ê²€ì‚¬í•œë‹¤. ë Œë”ë§ ì—¬ë¶€ í…ŒìŠ¤íŠ¸ë¼ê³  í•´ë„ ë¬´ë°©

## render() í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ í•¨ìˆ˜

### getBy~

~ë¡œ ì‹œì‘í•˜ëŠ” ì¿¼ë¦¬ëŠ” ì¡°ê±´ì— ì¼ì¹˜í•˜ëŠ” DOM ì—˜ë¦¬ë¨¼íŠ¸ í•˜ë‚˜ë¥¼ ì„ íƒ. ë§Œì•½ì— ì—†ë‹¤ë©´ ì—ëŸ¬ ë°œìƒ. í˜„ì¬ê¹Œì§€ëŠ” getBy~ í•¨ìˆ˜ë¡œë„ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ”ë° ë¬´ë¦¬ê°€ ì—†ì—ˆë‹¤. query~ ë„ ìˆê³  find~ ë„ ìˆë‹¤.

ex) `getByText`, `getByLabelText`, `getByAltText`, `getByPlaceholderText`

## ğŸ† ë Œë”ë§ í…ŒìŠ¤íŠ¸

```tsx
// counter.test.tsx

import { render, screen } from '@testing-library/react'
import Counter from '.'

describe('<Counter /> Test', () => {
	const renderCounter = () => render(<Counter />)

	test('<CountText/> render test', () => {
		renderCounter()
    const countEle = screen.getByTestId('counter-text')
    expect(countEle).toBeInTheDocument()
  })

  test('<Counter/> Buttons render test', () => {
    renderCounter()
    const upButton = screen.getByTestId('counter-up-button')
    const downButton = screen.getByTestId('counter-down-button')
    const clearButton = screen.getByTestId('counter-clear-button')

    expect(upButton && downButton && clearButton).toBeInTheDocument()
  })
}
```

ì»´í¬ë„ŒíŠ¸ ê°ê°ì˜ `Dom Element` ìš”ì†Œ ì†ì„±ì— `data-testid` ê°’ì„ í• ë‹¹í–ˆë‹¤. `querySelector()`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒë³´ë‹¤ ìš©ë„ì— ë§ëŠ” query í•¨ìˆ˜ê°€ ì œê³µë˜ë¯€ë¡œ ì•Œë§ê²Œ ì‚¬ìš©í•œë‹¤. `querySelector()` ë¡œ **DOM** ìš”ì†Œë¥¼ ì°¾ëŠ”ë‹¤ë©´ ifë¬¸ìœ¼ë¡œ ê°’ì„ ì²´í¬ê¹Œì§€ í•´ì¤˜ì•¼í•˜ë¯€ë¡œ ì•Œë§ì€ query í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì(í•´ë‹¹ DOM ìš”ì†Œë£° ëª»ì°¾ìœ¼ë©´ ì—ëŸ¬ë¡œ ì¢…ë£Œì‹œì¼œ ë²„ë¦¬ê¸° ë•Œë¬¸ì— ê°„í¸í•¨ ğŸ‘)

```html
<button type="button" data-testid="counter-up-button">Up<button>
```

## ğŸŒ€ Jest ë¼ì´í”„ì‚¬ì´í´

ì»´í¬ë„ŒíŠ¸ê°€ ë³µì¡í•´ì§€ë©´ ìì—°ìŠ¤ë ˆ í…ŒìŠ¤íŠ¸ ì½”ë“œë„ ë³µì¡í•´ì§€ëŠ”ë°, ìì—°ìŠ¤ë ˆ ì‚¬ìš©í•  ê²ƒ ê°™ë‹¤. ê°•ì˜ì—ì„œ DBì„œë²„ì— ì—°ê²°í•˜ëŠ”ë° ì‚¬ìš© í–ˆë˜ ê²ƒ ê°™ë‹¤.

- `beforeAll` : í…ŒìŠ¤íŠ¸ íŒŒì¼ ë‚´ ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‘ì—… ì „ í•œë²ˆë§Œ ì‹¤í–‰
- `beforeEach` : ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‘ì—… ì „ì— ì‹¤í–‰
- `afterAll` : í…ŒìŠ¤íŠ¸ íŒŒì¼ ë‚´ ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‘ì—… ì¢…ë£Œ í›„ í•œë²ˆë§Œ ì‹¤í–‰
- `beforeAll` : ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¢…ë£Œ í›„ ì‹¤í–‰

## ğŸ—‘ï¸ ë¹Œë“œí•  ë•Œ data-testId ì†ì„± ì œê±°í•˜ê¸°

`data-testId` ì†ì„±ì„ ì‚¬ìš©í•´ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì°¾ëŠ”ë°, ë¹Œë“œ ë‹¨ê³„ì—ì„œ ëª¨ë‘ ì œê±°í•˜ê³  ì‹¶ì–´ ê´€ë ¨ ë‚´ìš©ì„ ì°¾ì•„ ë´¤ê³  Viteë¥¼ ì§€ì›í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìˆì—ˆë‹¤.

```bash
yarn add -D react-remove-attr
```

```tsx
...
import removeAttr from 'react-remove-attr'

...
export default defineConfig(({ mode }) => {

	const removeAttrPlugin = isProd && removeAttr({ extensions: ['jsx', 'tsx'], attributes: ['data-testid'] })

	return {
		plugins: [removeAttrPlugin(), ...]
	}

})
...
```

ë‹¤ë§Œ í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” **GPL-3.0** ë¼ì´ì„¼ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆë‹¤.

[ì˜¤í”ˆ ì†ŒìŠ¤ ê°œë°œìê°€ ê¼­ ì•Œì•„ì•¼ í•  GPL 3.0 ë¼ì´ì„ ìŠ¤ì˜ ì£¼ìš” ì‚¬í•­](https://ycc4477.tistory.com/entry/%EC%98%A4%ED%94%88-%EC%86%8C%EC%8A%A4-%EA%B0%9C%EB%B0%9C%EC%9E%90%EA%B0%80-%EA%BC%AD-%EC%95%8C%EC%95%84%EC%95%BC-%ED%95%A0-GPL-30-%EB%9D%BC%EC%9D%B4%EC%84%A0%EC%8A%A4%EC%9D%98-%EC%A3%BC%EC%9A%94-%EC%82%AC%ED%95%AD)