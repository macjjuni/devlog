---
title: "useRef Hook ë™ì  í• ë‹¹í•˜ê¸°"
category: Dev
tag: ["React"]
date: 2024-03-14
author: ê¾¸ìƒ
---

`useRef`ëŠ” ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ ì•ˆì—ì„œ ë Œë”ë§ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê°’ì„ ì°¸ì¡°í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í›…(Hook)ì´ë‹¤. ë³´í†µ DOM Element ë˜ëŠ” ë‹¨ìˆœ ë³€ìˆ˜ë¥¼ í• ë‹¹í•´ ì‚¬ìš©í•œë‹¤. ì´ì „ ë¦¬ì•¡íŠ¸ì—ì„œ `let` ë³€ìˆ˜ ëŒ€ì‹  `useRef` ë¥¼ ì™œ ì‚¬ìš©í•˜ëŠ”ì§€ í¬ìŠ¤íŒ…ì„ í–ˆëŠ”ë°, ì´ë²ˆì—” ë‹¤ë¥¸ í¬ìŠ¤íŒ… ì†Œì¬ê°€ ìƒê²¼ë‹¤.

![useRef](/archive/dev/dynamic-useRef/slack.webp)

ğŸ™„

## ğŸ”¥ ë°˜ë³µë˜ëŠ” Element ìš”ì†Œì— ë™ì  Ref í• ë‹¹

ê°œì¸ì ìœ¼ë¡œ ë¦¬ì•¡íŠ¸ì—ì„œ `useRef`ì— ë‹¨ì¼ Element ìš”ì†Œë§Œ í• ë‹¹í•´ ì‚¬ìš©í–ˆë‹¤. Vue ì—ì„œëŠ” ë™ì  í• ë‹¹ì„ í•´ë³¸ ì  ìˆì§€ë§Œ ì™œ ë¦¬ì•¡íŠ¸ì—ì„  ì²˜ìŒì¸ì§€ ì˜ë¬¸ì´ë‹¤. ì•„ë¬´íŠ¼ ì´ë²ˆ ëª©í‘œëŠ” ë™ì ìœ¼ë¡œ `useRef`ë¥¼ í• ë‹¹í•˜ê¸° ìœ„í•´ ì»¤ìŠ¤í…€ í›…ì„ ì‘ì„±í•´ ì‰½ê²Œ ë°˜ë³µë˜ëŠ” ì»´í¬ë„ŒíŠ¸ ìš”ì†Œì— `ref`ë¥¼ ì„ ì–¸í•  ê²ƒì´ë‹¤.

### ğŸ¶ ë°˜ë³µë˜ëŠ” ì»´í¬ë„ŒíŠ¸

```jsx
import { KButton } from 'kku-ui'

const items = [
  { title: 'Not', value: '1' },
  { title: 'your', value: '2' },
  { title: 'keys', value: '3' },
  { title: 'not', value: '4' },
  { title: 'your', value: '5' },
  { title: 'Bitcoin', value: '6' },
]

export default function Component() {

  return (
    <>
      {items.map((item) => (<KButton key={item.value}>{item.title}</KButton>)}
    </>
  )
}
```

`items` ë°°ì—´ ìš”ì†Œë§Œí¼ `<KButton/>`ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•˜ëŠ” ì½”ë“œë‹¤.  (`v-for`ì™€ ë™ì¼) `<KButton/>`ì€ ë‚´ê°€ ê°œë°œí•˜ê³  ìˆëŠ” [kku-ui](https://www.npmjs.com/package/kku-ui) ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ë° ê¹¨ì•Œ ìë‘í•´ë³¸ë‹¤.

`items`ëŠ” 6ê°œì— ê°ì²´ê°€ ìˆìœ¼ë‹ˆ 6ê°œ `ref`ë¥¼ ë§Œë“¤ì–´ ì¤˜ì•¼ í•œë‹¤. ì´ë¦„ì€ `useDynamicRef`ê°€ ì œê²©ì´ë‹¤ ğŸ™„

### ğŸ“ useDynamicRef Hook ì‘ì„±

#### ğŸ“Œ 1. Hook ë¼ˆëŒ€ ì‘ì„±

```tsx
export default function useDynamicRef<T>() {
  ...
}
```

ì½”ë“œ ìˆ˜ë¥¼ ì¤„ì´ê¸° ìœ„í•´ í™”ì‚´í‘œ í•¨ìˆ˜ê°€ ì•„ë‹Œ `function` í‚¤ì›Œë“œë¡œ ì •ì˜í•˜ê³  `esm` ë‚´ë³´ë‚´ê¸°ë¥¼ ì‹œì „ í•œë‹¤. íƒ€ì…ì€ `ì œë„¤ë¦­<T>`ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ìª½ì—ì„œ ì§ì ‘ íƒ€ì…ì„ ì •ì˜í•˜ê²Œ í•´ ë‚´ ì¼ê°ì„ ì³ë‚¸ë‹¤.

#### ğŸ“Œ 2. ë³€ìˆ˜ ì„ ì–¸

```tsx
import { useRef } from 'react'

export default function useDynamicRef<T>() {

  const dynamicRef = useRef<{T[]}>({});
  const keys = useRef<string[]>([]);
  ...

  return { dynamicRef };
}
```

ì œë„¤ë¦­ìœ¼ë¡œ ë°›ì€ íƒ€ì…ì´ ë°°ì—´ í˜•ì‹ìœ¼ë¡œ ë‹´ê¸°ëŠ” `dynamicRef`ë¥¼ ì„ ì–¸í–ˆë‹¤. ê¸°ì¡´ì—ëŠ” ê°ì²´ í˜•íƒœë¡œ ë§Œë“¤ì—ˆëŠ”ë°, ì£¼ë¡œ ë°°ì—´ë¡œ ë§ì´ ë‹¤ë¤˜ê¸° ë•Œë¬¸ì— ë°°ì—´ í˜•íƒœë¡œ ì¬ì‘ì„± í–ˆë‹¤. ê·¸ë˜ì„œ ë°°ì—´ì— ë‹´ê¸¸ ë•Œ ìˆœì„œë¥¼ ë³´ì¥ì‹œì¼œì£¼ê¸° ìœ„í•´ `keys` ë¼ëŠ” ë°°ì—´ë„ ì„ ì–¸í•´ ì¤¬ë‹¤.

#### ğŸ“Œ 3. í•¨ìˆ˜ ì‘ì„±

```tsx
import { useRef, useCallback } from 'react'

export default function useDynamicRef<T>() {

  const dynamicRef = useRef<{T[]}>({});
  const keys = useRef<string[]>([]);

  const handleRef = useCallback((key: string) => {

		return (ref: T) => {

		  const keyIdx = keys.current.indexOf(key);

		      if (keyIdx !== -1) {
		          dynamicRef.current[keyIdx] = ref;
		          return;
		      }
		      keys.current.push(key);
		      dynamicRef.current.push(ref);
	  };
	}, []);

  ...
  ...
}
```

`handleRef`í•¨ìˆ˜ëŠ” ë°˜ë³µë˜ëŠ” `ref`ë¥¼ ì´ˆê¸°í™”í•˜ëŠ” ì—­í• ì„ í•œë‹¤. íŒŒë¼ë¯¸í„°ë¡œ í• ë‹¹í•  ê°ì²´ `key`ê°’ì„ ë°›ëŠ”ë°, ë³´í†µ ë¦¬ì•¡íŠ¸ì—ì„œ ë°˜ë³µë˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼  `map()` í•¨ìˆ˜ë¡œ ëŒë¦´ ë•Œ ì‚¬ìš©í•˜ëŠ” `key` ê°’ìœ¼ë¡œ ë™ì¼í•˜ê²Œ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

`handleRef()` í•¨ìˆ˜ ë¡œì§ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. íŒŒë¼ë¯¸í„°ë¡œ ë°›ì€ ë¬¸ìì—´ keyë¥¼ `keys` ë°°ì—´ì— í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ ì°¾ëŠ”ë‹¤.
2. ë§Œì•½ ì—†ëŠ” ê²½ìš° `keys` ì™€ `dynamicRefs` ë°°ì—´ì— ì¶”ê°€í•˜ê³  ë¹ ì ¸ë‚˜ê°„ë‹¤.
3. `keys` ë°°ì—´ì— í¬í•¨ëœ ê²½ìš° í•´ë‹¹ `key` ì¸ë±ìŠ¤ ìˆœì„œì— ë§ê²Œ  `dynamicRefs`ì— ê°’ì„ ì´ˆê¸°í™” í•œë‹¤.

#### ğŸ“Œ 4. ìµœì¢… ì‘ì„±ëœ ì½”ë“œ

```tsx
import { useRef, useCallback } from 'react'

export default function useDynamicRef<T>() {

  const dynamicRefs = useRef<{T[]}>([]);
  const keys = useRef<string[]>([]);

  const handleRef = useCallback((key: string) => {

		return (ref: T) => {

		  const keyIdx = keys.current.indexOf(key);

		      if (keyIdx !== -1) {
		          dynamicRef.current[keyIdx] = ref;
		          return;
		      }
		      keys.current.push(key);
		      dynamicRefs.current.push(ref);
	  };
	}, []);

  return { refs: dynamicRefs.current, handleRef };
}
```

ë§ˆì§€ë§‰ return ì—ì„œëŠ” refsë¼ëŠ” ì´ë¦„ìœ¼ë¡œ dynamicRefs.current ë¡œ ë°˜í™˜í•´ì£¼ëŠ” ì„¼ìŠ¤ ğŸ˜

#### âœ… useDynamicRef ì‚¬ìš©í•˜ê¸°

```tsx
import { KButton, KButtonRefs } from 'kku-ui'
import useDynamicRef from '@/lib/useDynamicRef'

const items = [
  { title: 'Not', value: '1' },
  { title: 'your', value: '2' },
  { title: 'keys', value: '3' },
  { title: 'not', value: '4' },
  { title: 'your', value: '5' },
  { title: 'Bitcoin', value: '6' },
]

export default function Component() {

  const { refs: buttonRefs, handleRef } = useDynamicRef<KButtonRefs>();

  const onClick = () => {
    console.log(buttonRefs)
    buttonRefs.forEach((buttonRef) => {
      buttonRef.startLoading();
    })
  }

  return (
    <>
      {items.map((item) => (<KButton key={item.value}>{item.title}</KButton>)}
	    <KButton onClick={onClick}>Test</KButton>
    </>
  )
}
```

## ğŸ•ºğŸ» í…ŒìŠ¤íŠ¸

![í…ŒìŠ¤íŠ¸ ê²°ê³¼](/archive/dev/dynamic-useRef/ref.gif)